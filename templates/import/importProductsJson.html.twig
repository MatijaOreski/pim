<html>
<head>

    <style>
        select{
            width: 200px;
            height: 300px;
        }

        option{
            padding: 10px;
        }

        button{
            height: 30px;
        }

        button[id="pair"]{
            margin-inline: 50px;
        }

        .import{
            margin: 40px 40px 20px 20px;
        }

        #listOfPairedAttributes{
            margin-left: 50px;
        }

        #listOfPairedAttributes div{
            padding: 10px;
        }

        .mainContainer{
            display: flex;
            margin:20px;
        }

    </style>



</head>
<body>
<h1>
    MTS Pimcore Import
</h1>
<hr>




<div class="import">
    <form enctype="multipart/form-data" method="post" action="/product_import_json">
        <input type="file" name="file">
        <button type="submit" name="upload">Upload</button>
    </form>
</div>

<div style="display: flex">

    <div  class="mainContainer">

        <select multiple id="attrsFromCsv">
            {% for columnName in columnNames %}
                <option value="{{ columnName }}">{{ columnName }}</option>
            {% endfor %}
        </select>



        <button id="pairBtn"><-- Pair --></button>


        <select multiple id="attrsFromPim">
            <option value="productsName">Product name</option>
            <option value="description">Description</option>
            <option value="manufacturer">Manufacturer</option>
            <option value="ean">EAN</option>
            <option value="mpn">MPN</option>
            <option value="priceBrutto">Price Brutto</option>
            <option value="priceNetto">Price Netto</option>
            <option value="categories">Category</option>
        </select>

    </div>

    <div>

        <form enctype="multipart/form-data" method="post" action="/product_import_json">
            <select  name="listOfPairedAttributes[]" style="pointer-events: none;margin-top: 20px;" multiple id="listOfPairedAttributes"> </select>
            <input type="file" name="importFile">
            <input type="text" name="folderId">
            <button type="submit" class="import" name="import">Import</button>

        </form>

    </div>

</div>

<hr>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>

    let pairedAttrs = [];


    $("#pairBtn").click(function () {
        let pairsListHtmlString = "";
        let fromCsv = $("#attrsFromCsv").val();
        let fromPim = $("#attrsFromPim").val();
        let pairedListPim = [];
        $(".pairedAttr").each(function(){
            pairedListPim.push($(this).html().split(";")[1]);
        });
        if(pairedListPim.includes(fromPim[0])){
            alert(fromPim+" attribute from pimcore is already paired!");
        }
        else{
            pairedAttrs.push(fromCsv+";"+fromPim);
            pairedAttrs.forEach(function(attr){
                pairsListHtmlString+="<option  selected class='pairedAttr' name='pairedAttr' value="+attr+">" + attr + "</option>"
            });
            $("#listOfPairedAttributes").html(pairsListHtmlString);
        }
    })



</script>


</body>
</html>